# Template file for 'devkitpro-pacman'
pkgname=devkitpro-pacman
version=1.0.1
revision=4
wrksrc="pacman-devkitpro-pacman-${version}"
make_dirs="/opt/devkitpro/pacman/var/lib/pacman 0755 root root
 /opt/devkitpro/pacman/var/cache/pacman/pkg 0755 root root
 /opt/devkitpro/pacman/share/makepkg-template 0755 root root
 /opt/devkitpro/pacman/share/libalpm/hooks 0755 root root
 /usr/share/pacman/keyrings 0755 root root"
configure_args="--disable-doc --disable-shared --prefix=/opt/devkitpro/pacman
 --with-crypto=nettle --with-pkg-ext=.pkg.tar.xz --with-src-ext=.src.tar.xz
 --with-makepkg-template-dir=/opt/devkitpro/pacman/share/makepkg-template"
build_style=configure
hostmakedepends="autoconf automake libtool gettext-devel pkg-config"
makedepends="libarchive-devel nettle-devel gpgme-devel libcurl-devel"
short_desc="Nintendo Homebrew package manager"
maintainer="oreo639 <oreo6391@gmail.com>"
license="GPL-3.0-or-later"
homepage="https://www.devkitpro.org/"
distfiles="https://github.com/devkitPro/pacman/archive/devkitpro-pacman-${version}.tar.gz"
checksum=f5dd7e38f6ef6708a474a2ca7068a21bf94cff6584ed826e0d32aa3edf1c64ea

pre_configure() {
	autoreconf -fi
}

post_install() {
	ln -s /usr/share/pacman/keyrings "$DESTDIR/opt/devkitpro/pacman/share/pacman"
	vmkdir usr
	vmkdir usr/bin
	for f in dkp-makepkg dkp-pacman dkp-pacman-key dkp-repo-add dkp-repo-remove; do
		vbin "$FILESDIR/$f"
	done
}
